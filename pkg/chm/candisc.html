<html><head><title>Canonical discriminant analysis</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>candisc(candisc)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   candisc">
<param name="keyword" value="R:   candisc.mlm">
<param name="keyword" value="R:   coef.candisc">
<param name="keyword" value="R:   plot.candisc">
<param name="keyword" value="R:   print.candisc">
<param name="keyword" value="R:   summary.candisc">
<param name="keyword" value=" Canonical discriminant analysis">
</object>


<h2>Canonical discriminant analysis</h2>


<h3>Description</h3>

<p>
<code>candisc</code> performs a generalized canonical discriminant analysis for
one term in a multivariate linear model (i.e., an <code>mlm</code> object),
computing canonical scores and vectors.  It represents a transformation
of the original variables into a canonical space of maximal differences
for the term, controlling for other model terms.
To be of any use,
the term should be a factor or interaction corresponding to a
multivariate test with 2 or more degrees of freedom for the
null hypothesis.
</p>


<h3>Usage</h3>

<pre>
candisc(mod, ...)

## S3 method for class 'mlm':
candisc(mod, term, type = "2", manova, ndim = rank, ...)

## S3 method for class 'candisc':
coef(object, type = c("std", "raw", "structure"), ...)

## S3 method for class 'candisc':
plot(x, which = 1:2, conf = 0.95, col, pch, scale, asp = 1,
    var.col = "blue", var.lwd = par("lwd"), prefix = "Can", suffix=TRUE, ...)
    
## S3 method for class 'candisc':
print(x, digits=max(getOption("digits") - 2, 3), ...)

## S3 method for class 'candisc':
summary(object, means = TRUE, scores = FALSE, coef = c("std"),
    ndim, digits = max(getOption("digits") - 2, 4), ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>mod</code></td>
<td>
An mlm object, such as computed by lm() with a multivariate response</td></tr>
<tr valign="top"><td><code>term</code></td>
<td>
the name of one term from <code>mod</code></td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
type of test for the model <code>term</code>, one of: "II", "III", "2", or "3"</td></tr>
<tr valign="top"><td><code>manova</code></td>
<td>
the <code>Anova.mlm</code> object corresponding to <code>mod</code>.  Normally,
this is computed internally by  <code>Anova(mod)</code></td></tr>
<tr valign="top"><td><code>ndim</code></td>
<td>
Number of dimensions to store in (or retrieve from, for the <code>summary</code> method)
the <code>means</code>, <code>structure</code>, <code>scores</code> and
<code>coeffs.*</code> components.  The default is the rank of the H matrix for the hypothesis
term.</td></tr>
<tr valign="top"><td><code>object, x</code></td>
<td>
A candisc object</td></tr>
<tr valign="top"><td><code>which</code></td>
<td>
A vector of two integers, selecting the canonical dimensions to plot</td></tr>
<tr valign="top"><td><code>conf</code></td>
<td>
Confidence coefficient for the confidence circles plotted in the <code>plot</code> method</td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
A vector of colors to be used for the levels of the term in the <code>plot</code> method</td></tr>
<tr valign="top"><td><code>pch</code></td>
<td>
A vector of point symbols to be used for the levels of the term in the <code>plot</code> method</td></tr>
<tr valign="top"><td><code>scale</code></td>
<td>
Scale factor for the variable vectors in canonical space.  If not specified, a scale
factor is calculated to make the variable vectors approximately fill the plot space. </td></tr>
<tr valign="top"><td><code>asp</code></td>
<td>
Aspect ratio for the <code>plot</code> method.  The <code>asp=1</code> (the default) assures that
the units on the horizontal and vertical axes are the same, so that lengths and angles of the
variable vectors are interpretable.</td></tr>
<tr valign="top"><td><code>var.col</code></td>
<td>
Color used to plot variable vectors</td></tr>
<tr valign="top"><td><code>var.lwd</code></td>
<td>
Line width used to plot variable vectors</td></tr>
<tr valign="top"><td><code>prefix</code></td>
<td>
Prefix used to label the canonical dimensions plotted</td></tr>
<tr valign="top"><td><code>suffix</code></td>
<td>
Suffix for labels of canonical dimensions. If <code>suffix=TRUE</code>
the percent of hypothesis (H) variance accounted for by each canonical dimension is added to the axis label.</td></tr>
<tr valign="top"><td><code>means</code></td>
<td>
Logical value used to determine if canonical means are printed</td></tr>
<tr valign="top"><td><code>scores</code></td>
<td>
Logical value used to determine if canonical scores are printed</td></tr>
<tr valign="top"><td><code>coef</code></td>
<td>
Type of coefficients printed by the summary method. Any one or more of
"std", "raw", or "structure"</td></tr>
<tr valign="top"><td><code>digits</code></td>
<td>
significant digits to print.</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
arguments to be passed down.  In particular, <code>type="n"</code> can be used with
the <code>plot</code> method to suppress the display of canonical scores.</td></tr>
</table>

<h3>Details</h3>

<p>
Canonical discriminant analysis is typically carried out in conjunction with
a one-way MANOVA design. It represents a linear transformation of the response variables
into a canonical space in which (a) each successive canonical variate produces
maximal separation among the groups (e.g., maximum univariate F statistics), and
(b) all canonical variates are mutually uncorrelated. 
For a one-way MANOVA with g groups and p responses, there are 
<code>dfh</code> = min( g-1, p) such canonical dimensions, and tests, initally stated
by Bartlett (1938) allow one to determine the number of significant 
canonical dimensions.   Computational details for the one-way case are described
in Cooley &amp; Lohnes (1971), and in the SAS/STAT User's Guide,  "The CANDISC procedure:
Computational Details," <a href="http://support.sas.com/onlinedoc/913/getDoc/en/statug.hlp/candisc_sect12.htm">http://support.sas.com/onlinedoc/913/getDoc/en/statug.hlp/candisc_sect12.htm</a>.
</p>
<p>
A generalized canonical discriminant analysis extends this idea to a general
multivariate linear model.  Analysis of each term in the <code>mlm</code> produces
a rank <i>dfh</i> H matrix sum of squares and crossproducts matrix that is 
tested against the rank <i>dfe</i> E matrix by the standard multivariate
tests (Wilks' Lambda, Hotelling-Lawley trace, Pillai trace, Roy's maximum root
test).  For any given term in the <code>mlm</code>, the generalized canonical discriminant
analysis amounts to a standard discriminant analysis based on the H matrix for that
term in relation to the full-model E matrix.
</p>


<h3>Value</h3>

<p>
An object of class <code>candisc</code> with the following components:
</p>
<table summary="R argblock">
<tr valign="top"><td><code>dfh </code></td>
<td>
hypothesis degrees of freedom for <code>term</code></td></tr>
<tr valign="top"><td><code>dfe </code></td>
<td>
error degrees of freedom for the <code>mlm</code></td></tr>
<tr valign="top"><td><code>rank </code></td>
<td>
number of non-zero eigenvalues of $HE^{-1}$</td></tr>
<tr valign="top"><td><code>eigenvalues </code></td>
<td>
eigenvalues of $HE^{-1}$</td></tr>
<tr valign="top"><td><code>canrsq </code></td>
<td>
squared canonical correlations</td></tr>
<tr valign="top"><td><code>pct </code></td>
<td>
A vector containing the percentages of the <code>canrsq</code> of their total.</td></tr>
<tr valign="top"><td><code>ndim </code></td>
<td>
Number of canonical dimensions stored in the <code>means</code>, <code>structure</code> and <code>coeffs.*</code> components</td></tr>
<tr valign="top"><td><code>means </code></td>
<td>
A data.frame containing the class means for the levels of the factor(s) in the term</td></tr>
<tr valign="top"><td><code>factors </code></td>
<td>
A data frame containing the levels of the factor(s) in the <code>term</code></td></tr>
<tr valign="top"><td><code>term </code></td>
<td>
name of the <code>term</code></td></tr>
<tr valign="top"><td><code>terms </code></td>
<td>
A character vector containing the names of the terms in the <code>mlm</code> object</td></tr>
<tr valign="top"><td><code>coeffs.raw </code></td>
<td>
A matrix containing the raw canonical coefficients</td></tr>
<tr valign="top"><td><code>coeffs.std </code></td>
<td>
A matrix containing the standardized canonical coefficients</td></tr>
<tr valign="top"><td><code>structure </code></td>
<td>
A matrix containing the canonical structure coefficients on <code>ndim</code> dimensions, i.e.,
the correlations between the original variates and the canonical scores.
These are sometimes referred to as Total Structure Coefficients.</td></tr>
<tr valign="top"><td><code>scores </code></td>
<td>
A data frame containing the predictors in the <code>mlm</code> model and the
canonical scores on <code>ndim</code> dimensions. 
These are calculated as <code>Y %*% coeffs.raw</code>, where <code>Y</code> contains the
standardized response variables.</td></tr>
</table>

<h3>Author(s)</h3>

<p>
Michael Friendly and John Fox
</p>


<h3>References</h3>

<p>
Bartlett, M. S. (1938). Further aspects of the theory of multiple regression. Proc. Camb. Phil. Soc. 34, 33-34.
</p>
<p>
Cooley, W.W. &amp; Lohnes, P.R. (1971). Multivariate Data Analysis,  New York: Wiley.
</p>
<p>
Gittins, R. (1985). Canonical Analysis: A Review with Applications in Ecology,
Berlin: Springer.
</p>


<h3>See Also</h3>

<p>
<code><a href="candiscList.html">candiscList</a></code>, <code><a onclick="findlink('heplots', 'heplot.html')" style="text-decoration: underline; color: blue; cursor: hand">heplot</a></code>,  <code><a onclick="findlink('heplots', 'heplot3d.html')" style="text-decoration: underline; color: blue; cursor: hand">heplot3d</a></code>
</p>


<h3>Examples</h3>

<pre>
grass.mod &lt;- lm(cbind(N1,N9,N27,N81,N243) ~ Block + Species, data=Grass)
Anova(grass.mod,test="Wilks")

grass.can1 &lt;-candisc(grass.mod, term="Species")
plot(grass.can1, type="n")

# library(heplots)
heplot(grass.can1, scale=6)

# iris data
iris.mod &lt;- lm(cbind(Petal.Length, Sepal.Length, Petal.Width, Sepal.Width) ~ Species, data=iris)
iris.can &lt;- candisc(iris.mod, data=iris)
plot(iris.can)

heplot(iris.can)

</pre>

<script Language="JScript">
function findlink(pkg, fn) {
var Y, link;
Y = location.href.lastIndexOf("\\") + 1;
link = location.href.substring(0, Y);
link = link + "../../" + pkg + "/chtml/" + pkg + ".chm::/" + fn;
location.href = link;
}
</script>


<hr><div align="center">[Package <em>candisc</em> version 0.5-10 <a href="00Index.html">Index]</a></div>

</body></html>
